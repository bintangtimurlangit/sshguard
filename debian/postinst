#!/bin/bash
set -e

if [ "$1" = "configure" ]; then
    # Install Python packages via pip if not already installed
    echo "Checking Python dependencies..."
    
    # Check and install TensorFlow
    if ! python3 -c "import tensorflow" 2>/dev/null; then
        echo "Installing TensorFlow..."
        pip3 install --break-system-packages tensorflow>=2.10.0
    fi
    
    # Check and install pandas (if not available via apt)
    if ! python3 -c "import pandas" 2>/dev/null; then
        echo "Installing pandas..."
        pip3 install --break-system-packages pandas>=1.3.0
    fi
    
    # Check and install scikit-learn (if not available via apt)
    if ! python3 -c "import sklearn" 2>/dev/null; then
        echo "Installing scikit-learn..."
        pip3 install --break-system-packages scikit-learn>=1.0.0
    fi
    
    systemctl daemon-reload
    echo "SSHGuard installed. Enable with: systemctl enable sshguard"
fi

#DEBHELPER#
exit 0

